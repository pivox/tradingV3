monolog:
  channels: ['mtf', 'validation', 'signals', 'positions', 'positions_flow', 'bitmart', 'indicators', 'highconviction', 'pipeline_exec', 'deprecation', 'global-severity']
  handlers:
    # =====================
    # --- Handler Temporal (Asynchrone) ---
    # =====================

    # Handler principal qui publie vers Temporal via HTTP API

    # =====================
    # --- Fallback Handlers (Synchrones) ---
    # =====================

    # Canal MTF - Système Multi-Timeframe (fallback)
    mtf_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/mtf.log'
      max_files: 14
      level: '%env(MTF_LOG_LEVEL)%'
      channels: ['mtf']
      formatter: App\Logging\CustomLineFormatter

    # Canal Validation - Règles MTF et conditions YAML
    validation_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/validation.log'
      max_files: 14
      level: 'info'
      channels: ['validation']
      formatter: App\Logging\CustomLineFormatter

    # Canal Signals - Signaux longs/shorts
    signals_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/signals.log'
      max_files: 14
      level: '%env(LOG_LEVEL_SIGNALS)%'
      channels: ['signals']
      formatter: App\Logging\CustomLineFormatter

    # Canal Positions - Suivi des positions ouvertes/SL/TP
    positions_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/positions.log'
      max_files: 14
      level: '%env(LOG_LEVEL_POSITIONS)%'
      channels: ['positions']
      formatter: App\Logging\CustomLineFormatter

    # Canal Positions Flow - Traçage du flux 1m → placement d'ordre
    positions_flow_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/positions-flow.log'
      max_files: 14
      level: 'info'
      channels: ['positions_flow']
      formatter: App\Logging\CustomLineFormatter

    # Canal Indicators - Calculs d'indicateurs techniques
    indicators_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/indicators.log'
      max_files: 14
      level: '%env(LOG_LEVEL_INDICATORS)%'
      channels: ['indicators']
      formatter: App\Logging\CustomLineFormatter

    # Canal Bitmart - Traçage des appels API Bitmart (REST/Privé)
    bitmart_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/bitmart.log'
      max_files: 14
      level: 'info'
      channels: ['bitmart']
      formatter: App\Logging\CustomLineFormatter

    # Canal High Conviction - Stratégies validées
    highconviction_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/highconviction.log'
      max_files: 30
      level: '%env(LOG_LEVEL_HIGHCONVICTION)%'
      channels: ['highconviction']
      formatter: App\Logging\CustomLineFormatter

    # Canal Pipeline Exec - Moteur d'exécution workflow
    pipeline_exec_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/pipeline-exec.log'
      max_files: 30
      level: '%env(LOG_LEVEL_PIPELINE_EXEC)%'
      channels: ['pipeline_exec']
      formatter: App\Logging\CustomLineFormatter

    # =====================
    # --- Canaux Système ---
    # =====================

    # Canal Deprecation - Messages de dépréciation
    deprecation:
      type: stream
      path: 'php://stderr'
      level: notice
      channels: ['deprecation']
      formatter: App\Logging\CustomLineFormatter

    # Canal Global Severity - Consolidation erreurs ≥ notice
    global_severity_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/global-severity.log'
      max_files: 30
      level: error
      channels: ['global-severity']
      formatter: App\Logging\CustomLineFormatter

    # Canal Above Error - Collecte tous les logs > error (critical+)
    above_error_rotating:
      type: rotating_file
      path: '%kernel.project_dir%/var/log/above-error.log'
      max_files: 30
      level: critical
      channels: ['!event', '!doctrine', '!console']
      formatter: App\Logging\CustomLineFormatter

    # =====================
    # --- Handlers Généraux ---
    # =====================

    # Console pour développement
    console:
      type: console
      process_psr_3_messages: false
      channels: ['!event', '!doctrine', '!console']
      formatter: App\Logging\CustomLineFormatter

    # Handler principal (fallback)
    main:
      type: stream
      path: '%kernel.logs_dir%/%kernel.environment%.log'
      level: '%env(LOG_LEVEL_MAIN)%'
      channels: ['!event', '!deprecation']
      formatter: App\Logging\CustomLineFormatter
