# Profil SCALPER - TradeEntry
version: '2.5.93'

meta:
    name: SCALPING v2.0 - Profil SCALPER
    description: >
        Profil scalper : R plus petit, TP plus proche, même logique MTF.
        Exécution prioritaire 5m/1m, levier modulé par timeframe.
    created_at: '2025-11-10'

trade_entry:
    defaults:
        risk_pct_percent: 5.0
        initial_margin_usdt: 25.0
        fallback_account_balance: 0.0

        # R plus petit pour scalping
        r_multiple: 1.2
        tp1_r: 1.0

        stop_from: 'atr'
        atr_k: 1.5
        pivot_sl_policy: 'nearest_below'
        pivot_sl_buffer_pct: 0.003
        pivot_sl_min_keep_ratio: 0.8
        sl_full_size: true

        tp_policy: 'pivot_conservative'
        tp_buffer_pct: 0.001
        tp_buffer_ticks: 0
        tp_min_keep_ratio: 0.95
        tp_max_extra_r: 0.5

        order_type: 'limit'
        open_type: 'isolated'
        order_mode: 1

        market_max_spread_pct: 0.001
        inside_ticks: 1
        max_deviation_pct: 0.005
        implausible_pct: 0.02
        zone_max_deviation_pct: 0.015

        k_dynamic: 10.0

    risk:
        fixed_risk_pct: 5.0
        daily_max_loss_pct: 6.0
        daily_max_loss_usdt: 10.0
        daily_loss_count_unrealized: true
        max_concurrent_positions: 4
        meta: >
            Même risque nominal que le profil normal, mais R plus faible
            et fréquence d'entrées plus élevée.

    leverage:
        mode: dynamic_from_risk
        floor: 5.0
        exchange_cap: 100.0
        per_symbol_caps:
            - { symbol_regex: "^(BTC|ETH|BNB).*", cap: 15.0 }
            - { symbol_regex: "^NVDAXUSDT$", cap: 5.0 }

        timeframe_multipliers:
            '4h': 0.9
            '1h': 1.0
            '15m': 1.0
            '5m': 1.1
            '1m': 1.2

        confidence_multiplier:
            enabled: true
            default: 1.0
            when_upstream_stale: 0.8
            when_tie_breaker_used: 0.8

        conviction:
            enabled: true
            cap_pct_of_exchange: 0.60
            meta: >
                Boost limité sur les set-ups high-conviction, avec plafonds
                par symbole et par timeframe.

        rounding:
            precision: 2
            mode: floor

        meta: >
            Levier dérivé du risque et de la distance de stop (ATR),
            modulé un peu plus fort sur 5m/1m pour le scalping.

    decision:
        allowed_execution_timeframes: ['1m','5m','15m']
        require_price_or_atr: true

    entry:
        prefer_maker: true
        fallback_taker: true
        budget:
            mode: fixed_or_available
            fixed_usdt_if_available: 40
        quantization:
            price_tick: from_exchange
            qty_step: from_exchange
        slippage_guard_bps: 8
        spread_guard_bps: 6
        meta: >
            Budget identique au profil normal. Ajustable si tu veux
            des tickets plus petits pour le scalping.

    post_validation:
        entry_zone:
            vwap_anchor: true
            k_atr: 0.30
            w_min: 0.0005
            w_max: 0.0100
            quantize_to_exchange_step: true

        idempotency:
            decision_key_tpl: "{symbol}:{timeframe}:{candle_open_ts}"
            max_attempts: 3

        meta: >
            Même pipeline post-validation que le profil normal.
