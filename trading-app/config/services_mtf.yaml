services:
  # Services MTF
  App\MtfValidator\Service\MtfTimeService:
    arguments:
      $logger: '@logger'

  # HTTP Client (utilise maintenant BitmartHttpClientPublic)
  # App\Infrastructure\Http\BitmartClient: supprim√©, utilise App\Provider\Bitmart\Http\BitmartHttpClientPublic

  # Temporal Services

  # Controllers
  App\MtfValidator\Controller\MtfController:
    arguments:
      $mtfService: '@App\MtfValidator\Service\MtfService'
      $klineRepository: '@App\Provider\Repository\KlineRepository'
      $mtfStateRepository: '@App\Repository\MtfStateRepository'
      $mtfSwitchRepository: '@App\MtfValidator\Repository\MtfSwitchRepository'
      $mtfAuditRepository: '@App\MtfValidator\Repository\MtfAuditRepository'
      $mtfLockRepository: '@App\MtfValidator\Repository\MtfLockRepository'
      $logger: '@logger'
    tags: ['controller.service_arguments']

  # Commands
  App\Command\MtfWorkerCommand:
    arguments:
      $mtfWorker: '@App\Application\Worker\MtfWorker'
      $logger: '@logger'
    tags: ['console.command']

  App\Command\MtfWorkflowCommand:
    arguments:
      $workflowService: '@App\Application\Service\MtfWorkflowService'
      $logger: '@logger'
    tags: ['console.command']

  # HTTP Client Configuration
  http_client:
    class: Symfony\Component\HttpClient\CurlHttpClient
    arguments:
      $defaultOptions:
        timeout: 30
        max_redirects: 3
        headers:
          User-Agent: 'MTF-Trading-System/1.0'

  # Temporal Configuration
  temporal.workflow_client:
    class: Temporal\Client\WorkflowClient
    arguments:
      $serviceClient: '@temporal.service_client'

  temporal.service_client:
    class: Temporal\Client\GRPC\ServiceClient
    arguments:
      $hostPort: '%env(TEMPORAL_ADDRESS)%'
      $options: []

  temporal.worker_factory:
    class: Temporal\Worker\WorkerFactory
    arguments:
      $serviceClient: '@temporal.service_client'

