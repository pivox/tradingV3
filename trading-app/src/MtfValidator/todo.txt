1. CÃ´tÃ© MTF / Validator

Ajouter un sÃ©lecteur dâ€™exÃ©cution (MTF Execution Selector pragmatique) qui :

lit les validations 4h / 1h / 15m / 5m,

regarde au minimum :

expected_r_multiple,

entry_zone_width_pct,

atr_pct_15m,

adx_5m, spread_bps,

dÃ©cide un timeframe dâ€™exÃ©cution parmi : 15m, 5m, 1m.

Ne plus imposer la cascade jusquâ€™Ã  1m :

si le plan 15m est propre â†’ exÃ©cution 15m directement,

si 15m est moyen â†’ descente en 5m seulement si les filtres le permettent,

1m rÃ©servÃ© aux cas spÃ©ciaux (scalping, trailing aprÃ¨s TP1, fallback fin de zone).

Retourner une ExecutionDecision claire au TradeEntry :

executionTimeframe ('15m' | '5m' | '1m'),

expectedRMultiple,

entryZoneWidthPct,

Ã©ventuellement dâ€™autres mÃ©ta (ADX, spread, etc.).

2. CÃ´tÃ© TradeEntry (entrÃ©e du trade)

Ã‰tendre TradeEntryRequest pour inclure :

executionTimeframe (le TF choisi par le sÃ©lecteur),

les ATR utiles : atr15m, atr5m, atr1m (ou un accÃ¨s via IndicatorProviderInterface).

Adapter le calcul du SL (StopLossCalculator) :

choisir lâ€™ATR en fonction du timeframe dâ€™exÃ©cution :

exÃ©cution 15m â†’ ATR(15m),

exÃ©cution 5m â†’ ATR(5m) (fallback 15m si absent),

exÃ©cution 1m â†’ ATR(1m) (fallback 5m/15m).

appliquer la mÃªme formule quâ€™avant, mais avec cet ATR-lÃ  :

stop_distance_pct = k_stop_atr * atr_base / price.

Adapter le PositionSizer :

il ne change pas de logique,

mais la distance de stop quâ€™on lui passe dÃ©pend maintenant du TF :

15m â†’ stop plus large â†’ levier/taille plus petits,

5m â†’ stop plus serrÃ© â†’ levier/taille plus grands,

1m â†’ stop trÃ¨s serrÃ© â†’ levier plafonnÃ© par lev_max + liquidation guard.

ParamÃ©trer lâ€™Entry Zone par timeframe dâ€™exÃ©cution :

dans la config (YAML), ajouter une section par TF :

zone_ttl_sec spÃ©cifique 15m / 5m / 1m,

min_volume_ratio par TF,

quel TF dâ€™ATR utiliser pour la largeur de la zone,

si fallback_end_of_zone est autorisÃ© ou non.

dans EntryZoneBuilder / OrderPlanBuilder, lire ces paramÃ¨tres en fonction de executionTimeframe.

3. CÃ´tÃ© trailing / gestion aprÃ¨s lâ€™ouverture

Adapter le timeframe de suivi pour le trailing :

dÃ©finir une rÃ¨gle simple, par ex. :

exÃ©cution 15m â†’ trailing sur 5m,

exÃ©cution 5m â†’ trailing sur 1m,

exÃ©cution 1m â†’ trailing reste 1m.

recalc ATR / EMA sur ce TF de trailing pour dÃ©placer SL/TP.

4. En une phrase

ğŸ‘‰ On doit faire en sorte que le MTF ne choisisse plus systÃ©matiquement 1m, mais quâ€™il dÃ©cide dâ€™un timeframe dâ€™exÃ©cution (15m, 5m ou 1m), et que tout le module TradeEntry (ATR, SL, sizing, Entry Zone, TTL, trailing) se branche sur ce timeframe choisi au lieu de supposer â€œtoujours 1mâ€.
