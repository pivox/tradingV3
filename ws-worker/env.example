# ============================================================================
# WS Worker - Variables d'environnement (DOCUMENTATION UNIQUEMENT)
# ============================================================================
#
# ⚠️ CE FICHIER EST PUREMENT DOCUMENTAIRE
#
# MODE D'EMPLOI :
#
#   1. Créez un fichier .env à la RACINE du projet (tradingV3/.env)
#   2. Docker-compose charge ce fichier et injecte les variables dans le container
#   3. Voir docker-compose.yml lignes 264-295 pour le mapping des variables
#
# VARIABLES DU .ENV RACINE :
#
#   - BITMART_API_KEY           → injecté tel quel
#   - BITMART_SECRET_KEY        → mappé vers BITMART_API_SECRET dans le container
#   - BITMART_API_MEMO          → injecté tel quel
#   - WS_WORKER_SHARED_SECRET   → mappé vers TRADING_APP_SHARED_SECRET
#
# ⚠️ IMPORTANT : Ce fichier documente les variables DANS le container.
#                Consultez ENV_CONFIGURATION.md pour les variables du .env racine.
#
# ============================================================================

# ============================================================================
# BitMart WebSocket Configuration
# ============================================================================

# URL WebSocket publique (pour les klines)
BITMART_PUBLIC_WS_URI=wss://ws-pro.bitmart.com/api?protocol=1.1

# URL WebSocket privée (pour les ordres, positions, balance)
BITMART_PRIVATE_WS_URI=wss://ws-pro.bitmart.com/user?protocol=1.1

# Clés API BitMart (obligatoires pour les canaux privés)
# Obtenir sur : https://www.bitmart.com/api/en-US
BITMART_API_KEY=your_api_key_here
BITMART_API_SECRET=your_api_secret_here
BITMART_API_MEMO=your_api_memo_here

# ============================================================================
# Serveur de contrôle HTTP
# ============================================================================

# Adresse d'écoute du serveur de contrôle HTTP
# Format: IP:PORT
CTRL_ADDR=0.0.0.0:8089

# ============================================================================
# Configuration WebSocket
# ============================================================================

# Nombre de souscriptions envoyées par lot pour éviter le burst
SUBSCRIBE_BATCH=20

# Délai entre chaque lot de souscriptions (en millisecondes)
SUBSCRIBE_DELAY_MS=200

# Intervalle d'envoi des messages ping (en secondes)
PING_INTERVAL_S=15

# Délai avant reconnexion après une déconnexion (en secondes)
RECONNECT_DELAY_S=5

# ============================================================================
# Intégration avec trading-app - Signaux d'ordres
# ============================================================================

# URL de base de l'application trading-app
TRADING_APP_BASE_URI=http://localhost:8080

# Endpoint pour envoyer les signaux d'ordres
TRADING_APP_ORDER_SIGNAL_PATH=/api/ws-worker/orders

# Secret partagé pour l'authentification HMAC
# ⚠️ IMPORTANT : Doit être identique dans trading-app (WS_WORKER_SHARED_SECRET)
# Générer un secret fort : openssl rand -hex 32
TRADING_APP_SHARED_SECRET=change-me-to-a-secure-secret

# Timeout des requêtes HTTP vers trading-app (en secondes)
TRADING_APP_REQUEST_TIMEOUT=2.0

# Nombre maximum de tentatives en cas d'échec
TRADING_APP_SIGNAL_MAX_RETRIES=5

# Fichier de log des échecs d'envoi de signaux d'ordres
TRADING_APP_SIGNAL_FAILURE_LOG=var/order-signal-failures.log

# ============================================================================
# Intégration avec trading-app - Signaux de balance
# ============================================================================

# Endpoint pour envoyer les signaux de balance USDT
TRADING_APP_BALANCE_SIGNAL_PATH=/api/ws-worker/balance

# Fichier de log des échecs d'envoi de signaux de balance
TRADING_APP_BALANCE_FAILURE_LOG=var/balance-signal-failures.log

# ============================================================================
# Logging (optionnel)
# ============================================================================

# Endpoint pour envoyer les logs vers trading-app
# Si non défini, les logs seront uniquement en console
TRADING_LOG_ENDPOINT=http://localhost:8082/internal/log

# ============================================================================
# Notes importantes
# ============================================================================
#
# SÉCURITÉ :
#   - Le WS_WORKER_SHARED_SECRET du .env racine doit être identique dans trading-app
#   - Générer un secret fort : openssl rand -hex 32
#   - Ne jamais commiter le fichier .env
#   - Permissions du .env racine : chmod 600 tradingV3/.env
#
# BITMART API :
#   - Permissions requises : Futures Trading, Account & Balance
#   - Configurer l'IP whitelist si nécessaire sur BitMart
#   - Dans le .env racine : BITMART_SECRET_KEY (pas BITMART_API_SECRET)
#
# DOCUMENTATION COMPLÈTE :
#   - Configuration du .env racine : ENV_CONFIGURATION.md
#   - Guide complet : README_BITMART.md
#   - Docker-compose : docker-compose.yml (lignes 264-295)
#
# ============================================================================

